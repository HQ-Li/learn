<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>41-æ¡ˆä¾‹åˆ†æï¼ˆå››ï¼‰ï¼šé«˜æ€§èƒ½æ•°æ®åº“è¿æ¥æ± HiKariCP</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <style>
        html {
            color: #333;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
            font-family: Helvetica Neue, PingFang SC, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif
        }

        html.borderbox *,
        html.borderbox :after,
        html.borderbox :before {
            box-sizing: border-box
        }

        article,
        aside,
        blockquote,
        body,
        button,
        code,
        dd,
        details,
        dl,
        dt,
        fieldset,
        figcaption,
        figure,
        footer,
        form,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        header,
        hr,
        input,
        legend,
        li,
        menu,
        nav,
        ol,
        p,
        pre,
        section,
        td,
        textarea,
        th,
        ul {
            margin: 0;
            padding: 0
        }

        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block
        }

        audio,
        canvas,
        video {
            display: inline-block
        }

        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, Helvetica, sans-serif
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        fieldset,
        img {
            border: 0
        }

        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0
            }
        }

        abbr,
        acronym {
            border-bottom: 1px dotted;
            font-variant: normal
        }

        abbr {
            cursor: help
        }

        del {
            text-decoration: line-through
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400
        }

        ol,
        ul {
            list-style: none
        }

        caption,
        th {
            text-align: left
        }

        q:after,
        q:before {
            content: ""
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative
        }

        :root sub,
        :root sup {
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        a {
            color: #1abc9c
        }

        a:hover {
            text-decoration: underline
        }

        .typo a {
            border-bottom: 1px solid #1abc9c
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555
        }

        .typo a:hover,
        a,
        ins {
            text-decoration: none
        }

        .typo-u,
        u {
            text-decoration: underline
        }

        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px
        }

        code,
        pre,
        pre tt {
            font-family: Courier, Courier New, monospace
        }

        pre {
            background: hsla(0, 0%, 97%, .7);
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch
        }

        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: .8em;
            height: 10px
        }

        .typo-small,
        figcaption,
        small {
            font-size: .9em;
            color: #888
        }

        b,
        strong {
            font-weight: 700;
            color: #000
        }

        [draggable] {
            cursor: move
        }

        .clearfix:after,
        .clearfix:before {
            content: "";
            display: table
        }

        .clearfix:after {
            clear: both
        }

        .clearfix {
            zoom: 1
        }

        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all
        }

        .textwrap-table {
            table-layout: fixed
        }

        .serif {
            font-family: Palatino, Optima, Georgia, serif
        }

        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-ol,
        .typo-p,
        .typo-pre,
        .typo-table,
        .typo-ul,
        .typo dl,
        .typo form,
        .typo hr,
        .typo ol,
        .typo p,
        .typo pre,
        .typo table,
        .typo ul,
        blockquote {
            margin-bottom: 1rem
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Helvetica Neue, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            color: #000;
            line-height: 1.35
        }

        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6,
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6 {
            margin-top: 1.2em;
            margin-bottom: .6em;
            line-height: 1.35
        }

        .typo-h1,
        .typo h1 {
            font-size: 2em
        }

        .typo-h2,
        .typo h2 {
            font-size: 1.8em
        }

        .typo-h3,
        .typo h3 {
            font-size: 1.6em
        }

        .typo-h4,
        .typo h4 {
            font-size: 1.4em
        }

        .typo-h5,
        .typo-h6,
        .typo h5,
        .typo h6 {
            font-size: 1.2em
        }

        .typo-ul,
        .typo ul {
            margin-left: 1.3em;
            list-style: disc
        }

        .typo-ol,
        .typo ol {
            list-style: decimal;
            margin-left: 1.9em
        }

        .typo-ol ol,
        .typo-ol ul,
        .typo-ul ol,
        .typo-ul ul,
        .typo li ol,
        .typo li ul {
            margin-bottom: .8em;
            margin-left: 2em
        }

        .typo-ol ul,
        .typo-ul ul,
        .typo li ul {
            list-style: circle
        }

        .typo-table td,
        .typo-table th,
        .typo table caption,
        .typo table td,
        .typo table th {
            border: 1px solid #ddd;
            padding: .5em 1em;
            color: #666
        }

        .typo-table th,
        .typo table th {
            background: #fbfbfb
        }

        .typo-table thead th,
        .typo table thead th {
            background: hsla(0, 0%, 95%, .7)
        }

        .typo table caption {
            border-bottom: none
        }

        .typo-input,
        .typo-textarea {
            -webkit-appearance: none;
            border-radius: 0
        }

        .typo-em,
        .typo em,
        caption,
        legend {
            color: #000;
            font-weight: inherit
        }

        .typo-em {
            position: relative
        }

        .typo-em:after {
            position: absolute;
            top: .65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"
        }

        .typo img {
            max-width: 100%
        }

        .common-content {
            font-weight: 400;
            color: #353535;
            line-height: 1.75rem;
            white-space: normal;
            word-break: normal;
            font-size: 1rem
        }

        .common-content img {
            display: block;
            max-width: 100%;
            background-color: #eee
        }

        .common-content audio,
        .common-content video {
            width: 100%;
            background-color: #eee
        }

        .common-content center,
        .common-content font {
            margin-top: 1rem;
            display: inline-block
        }

        .common-content center {
            width: 100%
        }

        .common-content pre {
            margin-top: 1rem;
            padding-left: 0;
            padding-right: 0;
            position: relative;
            overflow: hidden
        }

        .common-content pre code {
            font-size: .8rem;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            width: 100%;
            box-sizing: border-box;
            padding-left: 1rem;
            padding-right: 1rem;
            overflow-x: auto
        }

        .common-content hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        .common-content b,
        .common-content h1,
        .common-content h2,
        .common-content h3,
        .common-content h4,
        .common-content h5,
        .common-content strong {
            font-weight: 700
        }

        .common-content h1,
        .common-content h2 {
            font-size: 1.125rem;
            margin-bottom: .45rem
        }

        .common-content h3,
        .common-content h4,
        .common-content h5 {
            font-size: 1rem;
            margin-bottom: .45rem
        }

        .common-content p {
            font-weight: 400;
            color: #353535;
            margin-top: .15rem
        }

        .common-content .orange {
            color: #ff5a05
        }

        .common-content .reference {
            font-size: 1rem;
            color: #888
        }

        .custom-rich-content h1 {
            margin-top: 0;
            font-weight: 400;
            font-size: 15.25px;
            border-bottom: 1px solid #eee;
            line-height: 2.8
        }

        .custom-rich-content li,
        .custom-rich-content p {
            font-size: 14px;
            color: #888;
            line-height: 1.6
        }

        table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        table.hljs-ln,
        table.hljs-ln tbody,
        table.hljs-ln td,
        table.hljs-ln tr {
            box-sizing: border-box
        }

        table.hljs-ln td {
            padding: 0;
            border: 0
        }

        table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            user-select: none
        }

        table.hljs-ln td.hljs-ln-code,
        table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            font-size: 12px;
            line-height: 20px;
            vertical-align: top
        }

        table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            color: #24292e;
            word-wrap: normal;
            white-space: pre
        }

        video::-webkit-media-controls {
            overflow: hidden !important
        }

        video::-webkit-media-controls-enclosure {
            width: calc(100% + 32px);
            margin-left: auto
        }

        ._29HP61GA_0 {
            max-width:800px;
            margin:0 auto;
            margin-bottom: 20px;
            font-weight: 400;
            color: #353535;
            line-height: 1.76;
            white-space: normal;
            word-break: normal;
            font-size: 17px;
            -webkit-transition: background-color .3s ease;
            transition: background-color .3s ease
        }

        ._29HP61GA_0 .MathJax_Display {
            overflow: auto
        }

        ._29HP61GA_0 .poster {
            position: fixed;
            left: -10000px;
            top: -10000px;
            overflow: hidden;
            padding: 1rem;
            background: #ececec
        }

        ._29HP61GA_0 .richcontent-pre-copy {
            font-size: 13px;
            color: #888;
            position: absolute;
            right: 1em;
            top: .5em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 .richcontent-pre-copy .iconfont {
            font-size: 12px;
            margin-right: .2em
        }

        ._29HP61GA_0 a {
            color: #fa8919;
            border-bottom: 1px solid #fa8919
        }

        ._29HP61GA_0 img {
            display: block;
            max-width: 100%;
            position: relative;
            left: 50%;
            -webkit-transform: translateX(-50%);
            transform: translateX(-50%);
            background-color: #eee;
            vertical-align: top;
            border-radius: 0
        }

        ._29HP61GA_0 audio,
        ._29HP61GA_0 video {
            width: 100%;
            background-color: #eee
        }

        ._29HP61GA_0 pre {
            margin-top: 16px;
            padding: 34px 0 0;
            margin-bottom: 30px;
            position: relative;
            border-radius: 6px;
            background: rgba(246, 247, 251, .749);
            border: 0
        }

        ._29HP61GA_0 pre code {
            font-size: 12px;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            margin-left: 16px;
            margin-right: 16px;
            overflow-x: scroll
        }

        ._29HP61GA_0 pre code:after {
            content: "";
            height: 30px;
            width: 100%;
            display: block
        }

        ._29HP61GA_0 hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        ._29HP61GA_0 h1,
        ._29HP61GA_0 h2,
        ._29HP61GA_0 h3,
        ._29HP61GA_0 h4,
        ._29HP61GA_0 h5 {
            margin-bottom: 20px;
            margin-top: 0;
            font-weight: 700
        }

        ._29HP61GA_0 b,
        ._29HP61GA_0 strong {
            font-weight: 700
        }

        ._29HP61GA_0 h1 {
            font-size: 21px
        }

        ._29HP61GA_0 h2 {
            font-size: 20px
        }

        ._29HP61GA_0 h3 {
            font-size: 19px
        }

        ._29HP61GA_0 h4 {
            font-size: 18px
        }

        ._29HP61GA_0 h5 {
            font-size: 17px
        }

        ._29HP61GA_0 center,
        ._29HP61GA_0 p {
            font-weight: 400;
            color: #353535;
            margin-top: 0;
            margin-bottom: 30px;
            word-break: break-word
        }

        ._29HP61GA_0 center {
            text-align: center
        }

        ._29HP61GA_0 blockquote {
            margin-top: 0;
            margin-bottom: 34px;
            border-left: 3px solid #e8e8e8;
            padding-left: 17px;
            color: #353535
        }

        ._29HP61GA_0 blockquote p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol,
        ._29HP61GA_0 ul {
            margin-bottom: 30px
        }

        ._29HP61GA_0 ol p,
        ._29HP61GA_0 ul p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol {
            list-style: decimal;
            margin-left: 20px
        }

        ._29HP61GA_0 ul li {
            padding-left: 17px;
            position: relative;
            margin-bottom: 10px
        }

        ._29HP61GA_0 ul li:after {
            content: "";
            height: 6px;
            width: 6px;
            border-radius: 50%;
            background: #353535;
            position: absolute;
            top: 10px;
            left: 0
        }

        ._29HP61GA_0 .orange {
            color: #fa8919
        }

        ._29HP61GA_0 .reference {
            color: #888
        }

        ._29HP61GA_0 .m-right {
            text-align: right
        }

        ._29HP61GA_0 .m-center {
            text-align: center;
            display: block
        }

        ._29HP61GA_0 .m-gray {
            color: #888
        }

        ._29HP61GA_0 .m-small {
            font-size: 15px
        }

        ._29HP61GA_0 table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        ._29HP61GA_0 table.hljs-ln,
        ._29HP61GA_0 table.hljs-ln tbody,
        ._29HP61GA_0 table.hljs-ln td,
        ._29HP61GA_0 table.hljs-ln tr {
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        ._29HP61GA_0 table.hljs-ln td {
            padding: 0;
            border: 0
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            font-size: 12px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code,
        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            line-height: 20px;
            vertical-align: top
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            font-size: 13px;
            color: #666;
            word-wrap: normal;
            white-space: pre
        }

    </style>
</head>
<body>
<div class="_29HP61GA_0">
<h1>41-æ¡ˆä¾‹åˆ†æï¼ˆå››ï¼‰ï¼šé«˜æ€§èƒ½æ•°æ®åº“è¿æ¥æ± HiKariCP</h1>
<p>å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ€»ä¼šéš¾å…å’Œæ•°æ®åº“æ‰“äº¤é“ï¼›åªè¦å’Œæ•°æ®åº“æ‰“äº¤é“ï¼Œå°±å…ä¸äº†ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± ã€‚ä¸šç•ŒçŸ¥åçš„æ•°æ®åº“è¿æ¥æ± æœ‰ä¸å°‘ï¼Œä¾‹å¦‚c3p0ã€DBCPã€Tomcat JDBC Connection Poolã€Druidç­‰ï¼Œä¸è¿‡æœ€è¿‘æœ€ç«çš„æ˜¯HiKariCPã€‚</p><p><strong>HiKariCPå·ç§°æ˜¯ä¸šç•Œè·‘å¾—æœ€å¿«çš„æ•°æ®åº“è¿æ¥æ± </strong>ï¼Œè¿™ä¸¤å¹´å‘å±•å¾—é¡ºé£é¡ºæ°´ï¼Œå°¤å…¶æ˜¯Springboot 2.0å°†å…¶ä½œä¸º<strong>é»˜è®¤æ•°æ®åº“è¿æ¥æ± </strong>åï¼Œæ±Ÿæ¹–ä¸€å“¥çš„åœ°ä½å·²æ˜¯æ¯‹åº¸ç½®ç–‘äº†ã€‚é‚£å®ƒä¸ºä»€ä¹ˆé‚£ä¹ˆå¿«å‘¢ï¼Ÿä»Šå¤©å’±ä»¬å°±é‡ç‚¹èŠèŠè¿™ä¸ªè¯é¢˜ã€‚</p><h2>ä»€ä¹ˆæ˜¯æ•°æ®åº“è¿æ¥æ± </h2><p>åœ¨è¯¦ç»†åˆ†æHiKariCPé«˜æ€§èƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯æ•°æ®åº“è¿æ¥æ± ã€‚æœ¬è´¨ä¸Šï¼Œæ•°æ®åº“è¿æ¥æ± å’Œçº¿ç¨‹æ± ä¸€æ ·ï¼Œéƒ½å±äºæ± åŒ–èµ„æºï¼Œä½œç”¨éƒ½æ˜¯é¿å…é‡é‡çº§èµ„æºçš„é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ï¼Œå¯¹äºæ•°æ®åº“è¿æ¥æ± æ¥è¯´ï¼Œä¹Ÿå°±æ˜¯é¿å…æ•°æ®åº“è¿æ¥é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒæœåŠ¡ç«¯ä¼šåœ¨è¿è¡ŒæœŸæŒæœ‰ä¸€å®šæ•°é‡çš„æ•°æ®åº“è¿æ¥ï¼Œå½“éœ€è¦æ‰§è¡ŒSQLæ—¶ï¼Œå¹¶ä¸æ˜¯ç›´æ¥åˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œè€Œæ˜¯ä»è¿æ¥æ± ä¸­è·å–ä¸€ä¸ªï¼›å½“SQLæ‰§è¡Œå®Œï¼Œä¹Ÿå¹¶ä¸æ˜¯å°†æ•°æ®åº“è¿æ¥çœŸçš„å…³æ‰ï¼Œè€Œæ˜¯å°†å…¶å½’è¿˜åˆ°è¿æ¥æ± ä¸­ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/0b/19/0b106876824e43d11750334e86556519.png" alt=""></p><center><span class="reference">æ•°æ®åº“è¿æ¥æ± ç¤ºæ„å›¾</span></center><p>åœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨å„ç§æŒä¹…åŒ–æ¡†æ¶æ¥å®Œæˆæ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ï¼ŒåŸºæœ¬ä¸Šä¸ä¼šç›´æ¥å’Œæ•°æ®åº“è¿æ¥æ± æ‰“äº¤é“ï¼Œä¸ºäº†èƒ½è®©ä½ æ›´å¥½åœ°ç†è§£æ•°æ®åº“è¿æ¥æ± çš„å·¥ä½œåŸç†ï¼Œä¸‹é¢çš„ç¤ºä¾‹ä»£ç å¹¶æ²¡æœ‰ä½¿ç”¨ä»»ä½•æ¡†æ¶ï¼Œè€Œæ˜¯åŸç”Ÿåœ°ä½¿ç”¨HiKariCPã€‚æ‰§è¡Œæ•°æ®åº“æ“ä½œåŸºæœ¬ä¸Šæ˜¯ä¸€ç³»åˆ—è§„èŒƒåŒ–çš„æ­¥éª¤ï¼š</p><!-- [[[read_end]]] --><ol>
<li>é€šè¿‡æ•°æ®æºè·å–ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼›</li>
<li>åˆ›å»ºStatementï¼›</li>
<li>æ‰§è¡ŒSQLï¼›</li>
<li>é€šè¿‡ResultSetè·å–SQLæ‰§è¡Œç»“æœï¼›</li>
<li>é‡Šæ”¾ResultSetï¼›</li>
<li>é‡Šæ”¾Statementï¼›</li>
<li>é‡Šæ”¾æ•°æ®åº“è¿æ¥ã€‚</li>
</ol><p>ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼Œé€šè¿‡ <code>ds.getConnection()</code> è·å–ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ—¶ï¼Œå…¶å®æ˜¯å‘æ•°æ®åº“è¿æ¥æ± ç”³è¯·ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“è¿æ¥ã€‚åŒæ ·ï¼Œé€šè¿‡ <code>conn.close()</code> é‡Šæ”¾ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ—¶ï¼Œä¹Ÿä¸æ˜¯ç›´æ¥å°†è¿æ¥å…³é—­ï¼Œè€Œæ˜¯å°†è¿æ¥å½’è¿˜ç»™æ•°æ®åº“è¿æ¥æ± ã€‚</p><pre><code>//æ•°æ®åº“è¿æ¥æ± é…ç½®
HikariConfig config = new HikariConfig();
config.setMinimumIdle(1);
config.setMaximumPoolSize(2);
config.setConnectionTestQuery(&quot;SELECT 1&quot;);
config.setDataSourceClassName(&quot;org.h2.jdbcx.JdbcDataSource&quot;);
config.addDataSourceProperty(&quot;url&quot;, &quot;jdbc:h2:mem:test&quot;);
// åˆ›å»ºæ•°æ®æº
DataSource ds = new HikariDataSource(config);
Connection conn = null;
Statement stmt = null;
ResultSet rs = null;
try {
  // è·å–æ•°æ®åº“è¿æ¥
  conn = ds.getConnection();
  // åˆ›å»ºStatement 
  stmt = conn.createStatement();
  // æ‰§è¡ŒSQL
  rs = stmt.executeQuery(&quot;select * from abc&quot;);
  // è·å–ç»“æœ
  while (rs.next()) {
    int id = rs.getInt(1);
    ......
  }
} catch(Exception e) {
   e.printStackTrace();
} finally {
  //å…³é—­ResultSet
  close(rs);
  //å…³é—­Statement 
  close(stmt);
  //å…³é—­Connection
  close(conn);
}
//å…³é—­èµ„æº
void close(AutoCloseable rs) {
  if (rs != null) {
    try {
      rs.close();
    } catch (SQLException e) {
      e.printStackTrace();
    }
  }
}
</code></pre><p><a href="https://github.com/brettwooldridge/HikariCP/wiki/Down-the-Rabbit-Hole">HiKariCPå®˜æ–¹ç½‘ç«™</a>è§£é‡Šäº†å…¶æ€§èƒ½ä¹‹æ‰€ä»¥å¦‚æ­¤ä¹‹é«˜çš„ç§˜å¯†ã€‚å¾®è§‚ä¸ŠHiKariCPç¨‹åºç¼–è¯‘å‡ºçš„å­—èŠ‚ç æ‰§è¡Œæ•ˆç‡æ›´é«˜ï¼Œç«™åœ¨å­—èŠ‚ç çš„è§’åº¦å»ä¼˜åŒ–Javaä»£ç ï¼ŒHiKariCPçš„ä½œè€…å¯¹æ€§èƒ½çš„æ‰§ç€å¯è§ä¸€æ–‘ï¼Œä¸è¿‡é—æ†¾çš„æ˜¯ä»–å¹¶æ²¡æœ‰è¯¦ç»†è§£é‡Šéƒ½åšäº†å“ªäº›ä¼˜åŒ–ã€‚è€Œå®è§‚ä¸Šä¸»è¦æ˜¯å’Œä¸¤ä¸ªæ•°æ®ç»“æ„æœ‰å…³ï¼Œä¸€ä¸ªæ˜¯FastListï¼Œå¦ä¸€ä¸ªæ˜¯ConcurrentBagã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•æå‡HiKariCPçš„æ€§èƒ½çš„ã€‚</p><h2>FastListè§£å†³äº†å“ªäº›æ€§èƒ½é—®é¢˜</h2><p>æŒ‰ç…§è§„èŒƒæ­¥éª¤ï¼Œæ‰§è¡Œå®Œæ•°æ®åº“æ“ä½œä¹‹åï¼Œéœ€è¦ä¾æ¬¡å…³é—­ResultSetã€Statementã€Connectionï¼Œä½†æ˜¯æ€»æœ‰ç²—å¿ƒçš„åŒå­¦åªæ˜¯å…³é—­äº†Connectionï¼Œè€Œå¿˜äº†å…³é—­ResultSetå’ŒStatementã€‚ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯å½“å…³é—­Connectionæ—¶ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å…³é—­Statementã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼ŒConnectionå°±éœ€è¦è·Ÿè¸ªåˆ›å»ºçš„Statementï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯å°†åˆ›å»ºçš„Statementä¿å­˜åœ¨æ•°ç»„ArrayListé‡Œï¼Œè¿™æ ·å½“å…³é—­Connectionçš„æ—¶å€™ï¼Œå°±å¯ä»¥ä¾æ¬¡å°†æ•°ç»„ä¸­çš„æ‰€æœ‰Statementå…³é—­ã€‚</p><p>HiKariCPè§‰å¾—ç”¨ArrayListè¿˜æ˜¯å¤ªæ…¢ï¼Œå½“é€šè¿‡ <code>conn.createStatement()</code> åˆ›å»ºä¸€ä¸ªStatementæ—¶ï¼Œéœ€è¦è°ƒç”¨ArrayListçš„add()æ–¹æ³•åŠ å…¥åˆ°ArrayListä¸­ï¼Œè¿™ä¸ªæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼›ä½†æ˜¯å½“é€šè¿‡ <code>stmt.close()</code> å…³é—­Statementçš„æ—¶å€™ï¼Œéœ€è¦è°ƒç”¨ ArrayListçš„remove()æ–¹æ³•æ¥å°†å…¶ä»ArrayListä¸­åˆ é™¤ï¼Œè¿™é‡Œæ˜¯æœ‰ä¼˜åŒ–ä½™åœ°çš„ã€‚</p><p>å‡è®¾ä¸€ä¸ªConnectionä¾æ¬¡åˆ›å»º6ä¸ªStatementï¼Œåˆ†åˆ«æ˜¯S1ã€S2ã€S3ã€S4ã€S5ã€S6ï¼ŒæŒ‰ç…§æ­£å¸¸çš„ç¼–ç ä¹ æƒ¯ï¼Œå…³é—­Statementçš„é¡ºåºä¸€èˆ¬æ˜¯é€†åºçš„ï¼Œå…³é—­çš„é¡ºåºæ˜¯ï¼šS6ã€S5ã€S4ã€S3ã€S2ã€S1ï¼Œè€ŒArrayListçš„remove(Object o)æ–¹æ³•æ˜¯é¡ºåºéå†æŸ¥æ‰¾ï¼Œé€†åºåˆ é™¤è€Œé¡ºåºæŸ¥æ‰¾ï¼Œè¿™æ ·çš„æŸ¥æ‰¾æ•ˆç‡å°±å¤ªæ…¢äº†ã€‚å¦‚ä½•ä¼˜åŒ–å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œä¼˜åŒ–æˆé€†åºæŸ¥æ‰¾å°±å¯ä»¥äº†ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/4b/a6/4b5e2ef70e46b087b139b331578a82a6.png" alt=""></p><center><span class="reference">é€†åºåˆ é™¤ç¤ºæ„å›¾</span></center><p>HiKariCPä¸­çš„FastListç›¸å¯¹äºArrayListçš„ä¸€ä¸ªä¼˜åŒ–ç‚¹å°±æ˜¯å°† <code>remove(Object element)</code> æ–¹æ³•çš„<strong>æŸ¥æ‰¾é¡ºåºå˜æˆäº†é€†åºæŸ¥æ‰¾</strong>ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒFastListè¿˜æœ‰å¦ä¸€ä¸ªä¼˜åŒ–ç‚¹ï¼Œæ˜¯ <code>get(int index)</code> æ–¹æ³•æ²¡æœ‰å¯¹indexå‚æ•°è¿›è¡Œè¶Šç•Œæ£€æŸ¥ï¼ŒHiKariCPèƒ½ä¿è¯ä¸ä¼šè¶Šç•Œï¼Œæ‰€ä»¥ä¸ç”¨æ¯æ¬¡éƒ½è¿›è¡Œè¶Šç•Œæ£€æŸ¥ã€‚</p><p>æ•´ä½“æ¥çœ‹ï¼ŒFastListçš„ä¼˜åŒ–ç‚¹è¿˜æ˜¯å¾ˆç®€å•çš„ã€‚ä¸‹é¢æˆ‘ä»¬å†æ¥èŠèŠHiKariCPä¸­çš„å¦å¤–ä¸€ä¸ªæ•°æ®ç»“æ„ConcurrentBagï¼Œçœ‹çœ‹å®ƒåˆæ˜¯å¦‚ä½•æå‡æ€§èƒ½çš„ã€‚</p><h2>ConcurrentBagè§£å†³äº†å“ªäº›æ€§èƒ½é—®é¢˜</h2><p>å¦‚æœè®©æˆ‘ä»¬è‡ªå·±æ¥å®ç°ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯ç”¨ä¸¤ä¸ªé˜»å¡é˜Ÿåˆ—æ¥å®ç°ï¼Œä¸€ä¸ªç”¨äºä¿å­˜ç©ºé—²æ•°æ®åº“è¿æ¥çš„é˜Ÿåˆ—idleï¼Œå¦ä¸€ä¸ªç”¨äºä¿å­˜å¿™ç¢Œæ•°æ®åº“è¿æ¥çš„é˜Ÿåˆ—busyï¼›è·å–è¿æ¥æ—¶å°†ç©ºé—²çš„æ•°æ®åº“è¿æ¥ä»idleé˜Ÿåˆ—ç§»åŠ¨åˆ°busyé˜Ÿåˆ—ï¼Œè€Œå…³é—­è¿æ¥æ—¶å°†æ•°æ®åº“è¿æ¥ä»busyç§»åŠ¨åˆ°idleã€‚è¿™ç§æ–¹æ¡ˆå°†å¹¶å‘é—®é¢˜å§”æ‰˜ç»™äº†é˜»å¡é˜Ÿåˆ—ï¼Œå®ç°ç®€å•ï¼Œä½†æ˜¯æ€§èƒ½å¹¶ä¸æ˜¯å¾ˆç†æƒ³ã€‚å› ä¸ºJava SDKä¸­çš„é˜»å¡é˜Ÿåˆ—æ˜¯ç”¨é”å®ç°çš„ï¼Œè€Œé«˜å¹¶å‘åœºæ™¯ä¸‹é”çš„äº‰ç”¨å¯¹æ€§èƒ½å½±å“å¾ˆå¤§ã€‚</p><pre><code>//å¿™ç¢Œé˜Ÿåˆ—
BlockingQueue&lt;Connection&gt; busy;
//ç©ºé—²é˜Ÿåˆ—
BlockingQueue&lt;Connection&gt; idle;
</code></pre><p>HiKariCPå¹¶æ²¡æœ‰ä½¿ç”¨Java SDKä¸­çš„é˜»å¡é˜Ÿåˆ—ï¼Œè€Œæ˜¯è‡ªå·±å®ç°äº†ä¸€ä¸ªå«åšConcurrentBagçš„å¹¶å‘å®¹å™¨ã€‚ConcurrentBagçš„è®¾è®¡æœ€åˆæºè‡ªC#ï¼Œå®ƒçš„ä¸€ä¸ªæ ¸å¿ƒè®¾è®¡æ˜¯ä½¿ç”¨ThreadLocalé¿å…éƒ¨åˆ†å¹¶å‘é—®é¢˜ï¼Œä¸è¿‡HiKariCPä¸­çš„ConcurrentBagå¹¶æ²¡æœ‰å®Œå…¨å‚è€ƒC#çš„å®ç°ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>ConcurrentBagä¸­æœ€å…³é”®çš„å±æ€§æœ‰4ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼šç”¨äºå­˜å‚¨æ‰€æœ‰çš„æ•°æ®åº“è¿æ¥çš„å…±äº«é˜Ÿåˆ—sharedListã€çº¿ç¨‹æœ¬åœ°å­˜å‚¨threadListã€ç­‰å¾…æ•°æ®åº“è¿æ¥çš„çº¿ç¨‹æ•°waitersä»¥åŠåˆ†é…æ•°æ®åº“è¿æ¥çš„å·¥å…·handoffQueueã€‚å…¶ä¸­ï¼ŒhandoffQueueç”¨çš„æ˜¯Java SDKæä¾›çš„SynchronousQueueï¼ŒSynchronousQueueä¸»è¦ç”¨äºçº¿ç¨‹ä¹‹é—´ä¼ é€’æ•°æ®ã€‚</p><pre><code>//ç”¨äºå­˜å‚¨æ‰€æœ‰çš„æ•°æ®åº“è¿æ¥
CopyOnWriteArrayList&lt;T&gt; sharedList;
//çº¿ç¨‹æœ¬åœ°å­˜å‚¨ä¸­çš„æ•°æ®åº“è¿æ¥
ThreadLocal&lt;List&lt;Object&gt;&gt; threadList;
//ç­‰å¾…æ•°æ®åº“è¿æ¥çš„çº¿ç¨‹æ•°
AtomicInteger waiters;
//åˆ†é…æ•°æ®åº“è¿æ¥çš„å·¥å…·
SynchronousQueue&lt;T&gt; handoffQueue;
</code></pre><p>å½“çº¿ç¨‹æ± åˆ›å»ºäº†ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ—¶ï¼Œé€šè¿‡è°ƒç”¨ConcurrentBagçš„add()æ–¹æ³•åŠ å…¥åˆ°ConcurrentBagä¸­ï¼Œä¸‹é¢æ˜¯add()æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œé€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯å°†è¿™ä¸ªè¿æ¥åŠ å…¥åˆ°å…±äº«é˜Ÿåˆ—sharedListä¸­ï¼Œå¦‚æœæ­¤æ—¶æœ‰çº¿ç¨‹åœ¨ç­‰å¾…æ•°æ®åº“è¿æ¥ï¼Œé‚£ä¹ˆå°±é€šè¿‡handoffQueueå°†è¿™ä¸ªè¿æ¥åˆ†é…ç»™ç­‰å¾…çš„çº¿ç¨‹ã€‚</p><pre><code>//å°†ç©ºé—²è¿æ¥æ·»åŠ åˆ°é˜Ÿåˆ—
void add(final T bagEntry){
  //åŠ å…¥å…±äº«é˜Ÿåˆ—
  sharedList.add(bagEntry);
  //å¦‚æœæœ‰ç­‰å¾…è¿æ¥çš„çº¿ç¨‹ï¼Œ
  //åˆ™é€šè¿‡handoffQueueç›´æ¥åˆ†é…ç»™ç­‰å¾…çš„çº¿ç¨‹
  while (waiters.get() &gt; 0 
    &amp;&amp; bagEntry.getState() == STATE_NOT_IN_USE 
    &amp;&amp; !handoffQueue.offer(bagEntry)) {
      yield();
  }
}
</code></pre><p>é€šè¿‡ConcurrentBagæä¾›çš„borrow()æ–¹æ³•ï¼Œå¯ä»¥è·å–ä¸€ä¸ªç©ºé—²çš„æ•°æ®åº“è¿æ¥ï¼Œborrow()çš„ä¸»è¦é€»è¾‘æ˜¯ï¼š</p><ol>
<li>é¦–å…ˆæŸ¥çœ‹çº¿ç¨‹æœ¬åœ°å­˜å‚¨æ˜¯å¦æœ‰ç©ºé—²è¿æ¥ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºé—²çš„è¿æ¥ï¼›</li>
<li>å¦‚æœçº¿ç¨‹æœ¬åœ°å­˜å‚¨ä¸­æ— ç©ºé—²è¿æ¥ï¼Œåˆ™ä»å…±äº«é˜Ÿåˆ—ä¸­è·å–ã€‚</li>
<li>å¦‚æœå…±äº«é˜Ÿåˆ—ä¸­ä¹Ÿæ²¡æœ‰ç©ºé—²çš„è¿æ¥ï¼Œåˆ™è¯·æ±‚çº¿ç¨‹éœ€è¦ç­‰å¾…ã€‚</li>
</ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œçº¿ç¨‹æœ¬åœ°å­˜å‚¨ä¸­çš„è¿æ¥æ˜¯å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹çªƒå–çš„ï¼Œæ‰€ä»¥éœ€è¦ç”¨CASæ–¹æ³•é˜²æ­¢é‡å¤åˆ†é…ã€‚åœ¨å…±äº«é˜Ÿåˆ—ä¸­è·å–ç©ºé—²è¿æ¥ï¼Œä¹Ÿé‡‡ç”¨äº†CASæ–¹æ³•é˜²æ­¢é‡å¤åˆ†é…ã€‚</p><pre><code>T borrow(long timeout, final TimeUnit timeUnit){
  // å…ˆæŸ¥çœ‹çº¿ç¨‹æœ¬åœ°å­˜å‚¨æ˜¯å¦æœ‰ç©ºé—²è¿æ¥
  final List&lt;Object&gt; list = threadList.get();
  for (int i = list.size() - 1; i &gt;= 0; i--) {
    final Object entry = list.remove(i);
    final T bagEntry = weakThreadLocals 
      ? ((WeakReference&lt;T&gt;) entry).get() 
      : (T) entry;
    //çº¿ç¨‹æœ¬åœ°å­˜å‚¨ä¸­çš„è¿æ¥ä¹Ÿå¯ä»¥è¢«çªƒå–ï¼Œ
    //æ‰€ä»¥éœ€è¦ç”¨CASæ–¹æ³•é˜²æ­¢é‡å¤åˆ†é…
    if (bagEntry != null 
      &amp;&amp; bagEntry.compareAndSet(STATE_NOT_IN_USE, STATE_IN_USE)) {
      return bagEntry;
    }
  }

  // çº¿ç¨‹æœ¬åœ°å­˜å‚¨ä¸­æ— ç©ºé—²è¿æ¥ï¼Œåˆ™ä»å…±äº«é˜Ÿåˆ—ä¸­è·å–
  final int waiting = waiters.incrementAndGet();
  try {
    for (T bagEntry : sharedList) {
      //å¦‚æœå…±äº«é˜Ÿåˆ—ä¸­æœ‰ç©ºé—²è¿æ¥ï¼Œåˆ™è¿”å›
      if (bagEntry.compareAndSet(STATE_NOT_IN_USE, STATE_IN_USE)) {
        return bagEntry;
      }
    }
    //å…±äº«é˜Ÿåˆ—ä¸­æ²¡æœ‰è¿æ¥ï¼Œåˆ™éœ€è¦ç­‰å¾…
    timeout = timeUnit.toNanos(timeout);
    do {
      final long start = currentTime();
      final T bagEntry = handoffQueue.poll(timeout, NANOSECONDS);
      if (bagEntry == null 
        || bagEntry.compareAndSet(STATE_NOT_IN_USE, STATE_IN_USE)) {
          return bagEntry;
      }
      //é‡æ–°è®¡ç®—ç­‰å¾…æ—¶é—´
      timeout -= elapsedNanos(start);
    } while (timeout &gt; 10_000);
    //è¶…æ—¶æ²¡æœ‰è·å–åˆ°è¿æ¥ï¼Œè¿”å›null
    return null;
  } finally {
    waiters.decrementAndGet();
  }
}
</code></pre><p>é‡Šæ”¾è¿æ¥éœ€è¦è°ƒç”¨ConcurrentBagæä¾›çš„requite()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„é€»è¾‘å¾ˆç®€å•ï¼Œé¦–å…ˆå°†æ•°æ®åº“è¿æ¥çŠ¶æ€æ›´æ”¹ä¸ºSTATE_NOT_IN_USEï¼Œä¹‹åæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ç­‰å¾…çº¿ç¨‹ï¼Œå¦‚æœæœ‰ï¼Œåˆ™åˆ†é…ç»™ç­‰å¾…çº¿ç¨‹ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™å°†è¯¥æ•°æ®åº“è¿æ¥ä¿å­˜åˆ°çº¿ç¨‹æœ¬åœ°å­˜å‚¨é‡Œã€‚</p><pre><code>//é‡Šæ”¾è¿æ¥
void requite(final T bagEntry){
  //æ›´æ–°è¿æ¥çŠ¶æ€
  bagEntry.setState(STATE_NOT_IN_USE);
  //å¦‚æœæœ‰ç­‰å¾…çš„çº¿ç¨‹ï¼Œåˆ™ç›´æ¥åˆ†é…ç»™çº¿ç¨‹ï¼Œæ— éœ€è¿›å…¥ä»»ä½•é˜Ÿåˆ—
  for (int i = 0; waiters.get() &gt; 0; i++) {
    if (bagEntry.getState() != STATE_NOT_IN_USE 
      || handoffQueue.offer(bagEntry)) {
        return;
    } else if ((i &amp; 0xff) == 0xff) {
      parkNanos(MICROSECONDS.toNanos(10));
    } else {
      yield();
    }
  }
  //å¦‚æœæ²¡æœ‰ç­‰å¾…çš„çº¿ç¨‹ï¼Œåˆ™è¿›å…¥çº¿ç¨‹æœ¬åœ°å­˜å‚¨
  final List&lt;Object&gt; threadLocalList = threadList.get();
  if (threadLocalList.size() &lt; 50) {
    threadLocalList.add(weakThreadLocals 
      ? new WeakReference&lt;&gt;(bagEntry) 
      : bagEntry);
  }
}
</code></pre><h2>æ€»ç»“</h2><p>HiKariCPä¸­çš„FastListå’ŒConcurrentBagè¿™ä¸¤ä¸ªæ•°æ®ç»“æ„ä½¿ç”¨å¾—éå¸¸å·§å¦™ï¼Œè™½ç„¶å®ç°èµ·æ¥å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯å¯¹äºæ€§èƒ½çš„æå‡éå¸¸æ˜æ˜¾ï¼Œæ ¹æœ¬åŸå› åœ¨äºè¿™ä¸¤ä¸ªæ•°æ®ç»“æ„é€‚ç”¨äºæ•°æ®åº“è¿æ¥æ± è¿™ä¸ªç‰¹å®šçš„åœºæ™¯ã€‚FastListé€‚ç”¨äºé€†åºåˆ é™¤åœºæ™¯ï¼›è€ŒConcurrentBagé€šè¿‡ThreadLocalåšä¸€æ¬¡é¢„åˆ†é…ï¼Œé¿å…ç›´æ¥ç«äº‰å…±äº«èµ„æºï¼Œéå¸¸é€‚åˆæ± åŒ–èµ„æºçš„åˆ†é…ã€‚</p><p>åœ¨å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬é‡åˆ°çš„å¹¶å‘é—®é¢˜åƒå·®ä¸‡åˆ«ï¼Œè¿™æ—¶é€‰æ‹©åˆé€‚çš„å¹¶å‘æ•°æ®ç»“æ„å°±éå¸¸é‡è¦äº†ã€‚å½“ç„¶èƒ½é€‰å¯¹çš„å‰ææ˜¯å¯¹ç‰¹å®šåœºæ™¯çš„å¹¶å‘ç‰¹æ€§æœ‰æ·±å…¥çš„äº†è§£ï¼Œåªæœ‰äº†è§£åˆ°æ— è°“çš„æ€§èƒ½æ¶ˆè€—åœ¨å“ªé‡Œï¼Œæ‰èƒ½å¯¹ç—‡ä¸‹è¯ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºä¸æˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºè®°å½•ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œä¹Ÿæ¬¢è¿æŠŠå®ƒåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/cf/aa/cf393cd748a4f0e6451807c4b61843aa.jpg" alt=""></p><h2>ç²¾é€‰ç•™è¨€ï¼š</h2>
        <ul>
        
<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            é˜¿å¥  2019-06-01 22:55:43
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            åŒé—®ï¼Œä¸ºä»€ä¹ˆè¯´çº¿ç¨‹æœ¬åœ°çš„è¿æ¥ä¼šè¢«çªƒå–å‘¢ï¼Ÿ [5èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            æ²™æ¼ é‡Œçš„éª†é©¼  2019-06-02 08:05:04
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            çªƒå–æ˜¯åœ¨è·å–æœ¬åœ°é“¾æ¥å¤±è´¥æ—¶ï¼Œéå†sharelistå®ç°çš„ [2èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            å³°  2019-06-01 17:33:43
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            æƒ³äº†åŠå¤©æ„Ÿè§‰ConcurrentBagåº”è¯¥æ˜¯æ± åŒ–çš„ä¸€ç§é€šç”¨æ€§ä¼˜åŒ–ï¼Œä½†å¥½åƒä¼šæœ‰é¥¥é¥¿é—®é¢˜ï¼Œå¦‚æœæŸäº›çº¿ç¨‹æ€»æ˜¯å ç”¨è¿æ¥ï¼Œé‚£ä¹ˆæŸäº›ä¸ç»å¸¸å ç”¨è¿æ¥çš„å°±å¯èƒ½ä¸€ç›´æ‹¿ä¸åˆ°è¿æ¥ï¼Œç¡¬æƒ³çš„ä¸€ä¸ªç¼ºç‚¹ï¼Œå“ˆå“ˆå“ˆã€‚ [2èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            å¼ å¾·  2019-06-02 11:39:14
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            å¼ºçƒˆå»ºè®®è€å¸ˆå†è®²ä¸€æœŸ   [1èµ]
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-06-03 14:14:09</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">å‘µå‘µğŸ˜„</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            QQæ€ª  2019-06-03 09:02:13
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            æ ¹æœ¬çœ‹ä¸å¤Ÿï¼Œå¼ºçƒˆå»ºè®®è€å¸ˆå†æ¥ä¸€ç¯‡ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-06-03 13:53:45</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">æˆ‘è§‰å¾—å¯ä»¥å¼€å¿ƒåœ°ç¬‘ä¸€ä¸‹ï¼Œç„¶åï¼Œå°±æ²¡ç„¶åäº†ğŸ˜‚ğŸ˜‚ğŸ˜‚</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            Zach_  2019-06-02 22:57:47
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è€å¸ˆï¼Œ æˆ‘çœ‹æ–‡ä¸­æåˆ°çš„æ˜¯è°ƒç”¨requite()é‡Šæ”¾é“¾æ¥çš„æ—¶å€™å°†è¿™ä¸ªé“¾æ¥æ·»åŠ åˆ°æœ¬åœ°å­˜å‚¨ä¸­ã€‚<br>é‚£æˆ‘æƒ³é—®ï¼Œå¦‚æœä¸æ˜¯è°ƒç”¨requite()æ–¹æ³•é‡Šæ”¾è¿æ¥çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè¿æ¥ç¬¬ä¸€æ¬¡è¢«æ”¾å…¥threadlocalæ˜¯ä»€ä¹ˆæ—¶å€™å•Šï¼Ÿ æ˜¯ç¬¬ä¸€æ¬¡è·å–è¿æ¥çš„æ—¶å€™å—ï¼Ÿ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-06-03 13:58:00</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">åªæœ‰requiteçš„æ—¶å€™ä¼šæ”¾åˆ°threatlocalé‡Œ</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            æ™“æ°  2019-06-02 20:59:20
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            åŒé—®ä¸ºä»€ä¹ˆçº¿ç¨‹æœ¬åœ°çš„ä¼šè¢«å…¶ä»–çº¿ç¨‹çªƒå–ï¼Œéº»çƒ¦è€å¸ˆè§£é‡Šä¸€ä¸‹ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-06-03 14:01:48</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">sharedlistå’Œå…¶ä»–çº¿ç¨‹çš„threadlocalé‡Œæœ‰å¯èƒ½éƒ½æœ‰åŒä¸€ä¸ªè¿æ¥ï¼Œä»å‰è€…å–åˆ°è¿æ¥ï¼Œå°±ç›¸å½“äºçªƒå–äº†åè€…</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            ç©ºçŸ¥  2019-06-02 20:37:17
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            çº¿ç¨‹æœ¬åœ°çš„è¿æ¥ä¼šè¢«çªƒå–   <br>è¿™ä¸ªæˆ‘è§‰å¾—æ˜¯å› ä¸º å¦‚æœ Tlé‡Œé¢æ²¡æœ‰ç©ºé—²çš„ ä¼šå» sharedListæŸ¥æ‰¾å¤„äº Not_In_Useçš„è¿æ¥ è¿™ä¸ªè¿æ¥å¯èƒ½å·²ç»åœ¨å…¶ä»–TLé‡Œé¢å­˜åœ¨äº† æ‰€ä»¥å°±ä¼šå‡ºç°çº¿ç¨‹T2ä»sharedListè·å–åˆ°äº† T1å­˜åœ¨TLé‡Œé¢å­˜æ”¾çš„æ²¡æœ‰ä½¿ç”¨çš„è¿æ¥è¿™ç§æƒ…å†µ 
        </div>
        <br/>
<div>
    <div style="color:#888;font-size:15.25px;font-weight:400;line-height:1.2">ä½œè€…å›å¤2019-06-03 14:02:10</div>
    <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">å‰å®³</div>
</div>
            
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            å¼ ä¸‰  2019-06-02 19:02:44
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            æ‰“å¡ï¼ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            é“¶æ—¶ç©ºdeæ¢¦  2019-06-02 16:48:38
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            æœ€åæ•°æ®åº“è¿æ¥éƒ½åˆ°çº¿ç¨‹æœ¬åœ°æ± ä¸­äº† 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            cricket1981  2019-06-02 10:05:15
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            å¯ä»¥ç”¨æ ˆstackæ¥ä»£æ›¿listå®ç°é€†åºå…³é—­S6~S1å—ï¼Ÿ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            é¾™çŒ«  2019-06-02 00:34:42
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            éœ€è¦å¤šçœ‹å‡ é 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            è‹å¿—è¾‰  2019-06-01 16:36:52
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            è¿™æ ·ä¼šä¸ä¼šå¯¼è‡´æ¯ä¸ªçº¿ç¨‹æŒæœ‰50ä¸ªä»¥ä¸‹é“¾æ¥ï¼Œè€Œä¸”æ¯ä¸ªé“¾æ¥å¯èƒ½åœ¨å¤šä¸ªçº¿ç¨‹å…±å­˜ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            æ§‘Â·å…ˆç”Ÿ  2019-06-01 15:27:45
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            é¢å‘ä¸šåŠ¡è®¾è®¡æ•°æ®ç»“æ„ï¼ŒèµğŸ‘ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            ä¸œæ–¹å¥‡éª¥  2019-06-01 09:52:28
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            ä»¥å‰åªçŸ¥é“ArrayListåˆ é™¤æ•ˆç‡ä½ï¼Œè¿™ä¼˜åŒ–æ€æƒ³ç»“åˆäº†ä¸šåŠ¡åœºæ™¯ï¼Œçœ‹èµ·æ¥ç®€å•ä¸è¯´å´ä¸çŸ¥é“ã€‚é¡¹ç›®è¿˜åœ¨springboot1.xç”¨çš„é˜¿é‡Œå·´å·´Druidï¼Œåé¢æ–°é¡¹ç›®2.xç”¨HaKriCPæ€§èƒ½åº”è¯¥ä¼šæ›´å¥½ã€‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;line-height:1.2">
            å†¯ä¼ åš  2019-06-01 08:49:07
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6">
            çº¿ç¨‹æœ¬åœ°çš„é“¾æ¥æ˜¯å¦‚ä½•è¢«çªƒå–çš„å‘¢ï¼Ÿ 
        </div>
        
    </div>
</li>
            </ul>
</div>
</body>
</html>